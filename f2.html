<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tan's Data Page</title>
  <!-- âœ… TAILWIND FOR QUICK STYLING -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gray-100 flex flex-col items-center justify-start p-4">
  <h1 class="text-2xl font-bold mb-4">ON-SITE - CAFETERIA (A) Data</h1>
  <div id="cards" class="flex flex-col gap-4 w-full max-w-md"></div>

  <script>
    // We'll fetch data from your published Google Sheet.
    // This link pulls the entire sheet as an array of objects.
    // If you'd like to parse strictly by row index, we can switch to an array-of-arrays approach.
    const sheetUrl = "https://opensheet.vercel.app/2PACX-1vQSM-lJx6SGgWefGw9s51MEALdSlpwnaUF9QrvvCiDLWTAH5YZKldb9_dFlgZ9yVmKk0yYKkY2QmBMS/ONSITE%20-%20CAFETERIA%20(A)";

    async function fetchTanData() {
      try {
        const res = await fetch(sheetUrl);
        const rows = await res.json();

        // We'll do a simple search:
        // 1) Find the row(s) that contain 'Tan' in *any* column.
        // 2) From that row, we'll display 'Tan' plus the 3 cells to the left.
        // NOTE: Because we're using an array of objects (with column names), "left" is not as direct.
        // If you want actual left columns, we'd need an array-of-arrays approach or known column names.

        // For demonstration, let's do:
        //   1) Find the key that contains 'Tan'
        //   2) Then show 3 other columns from the same row
        // We'll guess column headers. You can rename them if needed.

        const cardsDiv = document.getElementById('cards');
        rows.forEach((rowObj) => {
          // rowObj is an object like: { "NAME": "Tan", "ColA": "xyz", ... }
          // We'll see if any property includes "Tan".
          let foundTan = false;
          let foundKey = "";
          for (const key in rowObj) {
            if (rowObj[key] && rowObj[key].toString().includes("Tan")) {
              foundTan = true;
              foundKey = key;
              break;
            }
          }

          if (!foundTan) return; // skip if Tan not found.

          // We'll collect up to 3 columns to the left. Because we only have named columns,
          // let's just display everything in that row for demonstration.

          const dataStrings = Object.entries(rowObj)
            .map(([k, v]) => `${k}: ${v}`)
            .join("<br>");

          // Create a simple card
          const card = document.createElement('div');
          card.className = "bg-white p-4 rounded shadow";
          card.innerHTML = `
            <h2 class="text-lg font-bold mb-2">Found 'Tan' in column: ${foundKey}</h2>
            <p class="text-sm">${dataStrings}</p>
          `;
          cardsDiv.appendChild(card);
        });
      } catch (err) {
        console.error("Error fetching sheet:", err);
      }
    }

    fetchTanData();
  </script>
</body>
</html>
